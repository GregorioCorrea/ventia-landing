<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ventia ‚Äî COBROSMART Demo</title>

  <!-- Google Fonts (CDN only) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Syne:wght@700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0a0a0a;
      --paper:#f5f3ef;
      --ink:#111111;
      --muted:#6b6b6b;
      --green:#00c87a;
      --accent:#ff4d1c;

      --card: rgba(245,243,239,0.06);
      --border: rgba(245,243,239,0.14);
      --shadow: 0 16px 40px rgba(0,0,0,0.35);
      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 20% -10%, rgba(0,200,122,0.18), transparent 55%),
                  radial-gradient(900px 500px at 110% 10%, rgba(255,77,28,0.12), transparent 50%),
                  var(--bg);
      color: var(--paper);
      font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      line-height:1.35;
    }

    a{ color: inherit; }

    /* Layout */
    .app{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px 14px 42px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 8px 2px 18px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 220px;
    }

    .logo{
      width: 34px; height: 34px;
      border-radius: 10px;
      background: linear-gradient(135deg, rgba(0,200,122,1), rgba(0,200,122,0.45));
      box-shadow: 0 10px 24px rgba(0,200,122,0.20);
      position: relative;
      flex: 0 0 auto;
    }
    .logo::after{
      content:"V";
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      font-family: "Syne", sans-serif;
      font-weight:800;
      color: var(--bg);
      letter-spacing: -0.02em;
    }

    .titleblock .kicker{
      font-size: 12px;
      color: rgba(245,243,239,0.72);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .titleblock h1{
      margin: 2px 0 0;
      font-family: "Syne", sans-serif;
      font-weight: 800;
      font-size: 18px;
      letter-spacing: -0.02em;
    }

    .headerRight{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:10px;
      flex-wrap: wrap;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 9px 12px;
      border: 1px solid var(--border);
      background: rgba(245,243,239,0.04);
      border-radius: 999px;
      font-size: 12px;
      color: rgba(245,243,239,0.78);
    }
    .pill strong{ color: rgba(245,243,239,0.92); font-weight:700; }

    .screen{
      display:none;
      animation: fadeIn 260ms ease-out;
    }
    .screen.active{ display:block; }

    @keyframes fadeIn{
      from{ opacity:0; transform: translateY(4px); }
      to{ opacity:1; transform: translateY(0); }
    }

    .grid{
      display:grid;
      gap: 14px;
    }

    .card{
      background: rgba(245,243,239,0.04);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
    }

    .card h2{
      margin: 0 0 8px;
      font-family: "Syne", sans-serif;
      font-weight: 800;
      font-size: 16px;
      letter-spacing: -0.02em;
    }
    .subtle{
      color: rgba(245,243,239,0.72);
      font-size: 13px;
    }

    /* Buttons */
    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      align-items:center;
    }
    .btn{
      border:0;
      cursor:pointer;
      border-radius: 14px;
      padding: 12px 14px;
      font-weight: 700;
      font-size: 14px;
      font-family: "DM Sans", sans-serif;
      transition: transform 0.08s ease, filter 0.15s ease, background 0.15s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
    }
    .btn:active{ transform: translateY(1px) scale(0.99); }

    .btnPrimary{
      background: var(--green);
      color: var(--bg);
      box-shadow: 0 14px 30px rgba(0,200,122,0.22);
    }
    .btnPrimary:hover{ filter: brightness(1.02); }

    .btnGhost{
      background: rgba(245,243,239,0.05);
      border: 1px solid var(--border);
      color: var(--paper);
    }
    .btnGhost:hover{ background: rgba(245,243,239,0.07); }

    /* Screen 1 */
    .metrics{
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap: 12px;
    }
    .metric{
      background: rgba(245,243,239,0.04);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px;
    }
    .metric .label{
      font-size: 12px;
      color: rgba(245,243,239,0.72);
      margin-bottom: 8px;
    }
    .metric .value{
      font-family: "Syne", sans-serif;
      font-weight: 800;
      font-size: 20px;
      letter-spacing: -0.02em;
    }
    .metric .hint{
      margin-top: 8px;
      font-size: 12px;
      color: rgba(245,243,239,0.64);
    }

    .barwrap{
      margin-top: 8px;
      display:grid;
      gap: 10px;
    }
    .barRow{
      display:grid;
      grid-template-columns: 90px 1fr 110px;
      gap: 10px;
      align-items:center;
      padding: 8px 10px;
      border-radius: 14px;
      border: 1px solid rgba(245,243,239,0.10);
      background: rgba(245,243,239,0.03);
    }
    .barRow .bucket{
      font-weight:700;
      color: rgba(245,243,239,0.86);
      font-size: 13px;
    }
    .bar{
      height: 10px;
      border-radius: 999px;
      background: rgba(245,243,239,0.10);
      overflow:hidden;
      position:relative;
    }
    .bar > span{
      display:block;
      height:100%;
      width: 40%;
      border-radius:999px;
      background: rgba(0,200,122,0.70);
    }
    .barRow.prio .bar > span{ background: rgba(0,200,122,1); }
    .barRow.prio2 .bar > span{ background: rgba(0,200,122,0.90); }
    .barRow .amt{
      font-variant-numeric: tabular-nums;
      text-align:right;
      color: rgba(245,243,239,0.82);
      font-size: 13px;
    }

    /* Screen 2 */
    .split{
      display:grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap: 14px;
      align-items:start;
    }

    table{
      width:100%;
      border-collapse: separate;
      border-spacing: 0;
      overflow:hidden;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: rgba(245,243,239,0.03);
    }
    thead th{
      text-align:left;
      font-size: 12px;
      color: rgba(245,243,239,0.72);
      letter-spacing: 0.04em;
      text-transform: uppercase;
      padding: 12px 12px;
      border-bottom: 1px solid rgba(245,243,239,0.12);
      background: rgba(245,243,239,0.03);
      position: sticky;
      top:0;
      z-index:1;
    }
    tbody td{
      padding: 12px 12px;
      border-bottom: 1px solid rgba(245,243,239,0.08);
      font-size: 14px;
      color: rgba(245,243,239,0.88);
      vertical-align: middle;
    }
    tbody tr{
      cursor:pointer;
      transition: background 0.12s ease;
    }
    tbody tr:hover{
      background: rgba(245,243,239,0.06);
    }
    tbody tr.selected{
      outline: 2px solid rgba(0,200,122,0.55);
      outline-offset: -2px;
      background: rgba(0,200,122,0.08);
    }
    .tdRight{ text-align:right; font-variant-numeric: tabular-nums; }
    .tdCenter{ text-align:center; }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 700;
      border: 1px solid rgba(245,243,239,0.14);
      background: rgba(245,243,239,0.05);
      color: rgba(245,243,239,0.90);
    }
    .dot{
      width:8px; height:8px;
      border-radius:999px;
      background: rgba(245,243,239,0.55);
    }
    .status-red{ border-color: rgba(255,77,28,0.35); background: rgba(255,77,28,0.10); }
    .status-red .dot{ background: var(--accent); }
    .status-yellow{ border-color: rgba(245,213,94,0.35); background: rgba(245,213,94,0.10); }
    .status-yellow .dot{ background: rgba(245,213,94,0.95); }
    .status-green{ border-color: rgba(0,200,122,0.35); background: rgba(0,200,122,0.10); }
    .status-green .dot{ background: var(--green); }

    .panelHeader{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom: 10px;
    }
    .panelHeader h3{
      margin:0;
      font-family: "Syne", sans-serif;
      font-weight: 800;
      font-size: 15px;
      letter-spacing: -0.02em;
    }

    .toneRow{
      display:flex;
      gap:8px;
      flex-wrap: wrap;
      margin: 10px 0 10px;
    }
    .seg{
      display:flex;
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow:hidden;
      background: rgba(245,243,239,0.03);
    }
    .seg button{
      border:0;
      cursor:pointer;
      padding: 10px 10px;
      background: transparent;
      color: rgba(245,243,239,0.82);
      font-weight: 700;
      font-size: 13px;
      transition: background 0.12s ease;
      min-width: 92px;
      font-family: "DM Sans", sans-serif;
    }
    .seg button.active{
      background: rgba(0,200,122,0.16);
      color: rgba(245,243,239,0.95);
    }
    .seg button:hover{ background: rgba(245,243,239,0.06); }

    .msgPreview{
      border: 1px solid rgba(245,243,239,0.12);
      background: rgba(10,10,10,0.25);
      border-radius: 16px;
      padding: 12px;
      min-height: 140px;
    }
    .msgPreview .label{
      font-size: 12px;
      color: rgba(245,243,239,0.72);
      margin-bottom: 8px;
    }
    .msgBubble{
      background: rgba(245,243,239,0.92);
      color: var(--ink);
      border-radius: 16px;
      padding: 10px 12px;
      max-width: 100%;
      white-space: pre-wrap;
      font-size: 13px;
      line-height: 1.35;
      box-shadow: 0 10px 24px rgba(0,0,0,0.25);
    }

    .smallActions{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    .hintCard{
      border-radius: 16px;
      padding: 12px;
      border: 1px dashed rgba(245,243,239,0.18);
      background: rgba(245,243,239,0.03);
      color: rgba(245,243,239,0.74);
      font-size: 13px;
    }
    .hintCard strong{ color: rgba(245,243,239,0.92); }

    /* WhatsApp modal */
    .modalBackdrop{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.62);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 50;
    }
    .modalBackdrop.open{ display:flex; }

    .modal{
      width: min(560px, 100%);
      border-radius: 22px;
      border: 1px solid rgba(245,243,239,0.16);
      background: rgba(10,10,10,0.92);
      box-shadow: 0 24px 60px rgba(0,0,0,0.55);
      overflow:hidden;
    }
    .modalTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(245,243,239,0.10);
      background: rgba(245,243,239,0.03);
    }
    .modalTop .who{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .modalTop .who .name{
      font-family:"Syne", sans-serif;
      font-weight:800;
      font-size: 14px;
      letter-spacing:-0.01em;
    }
    .modalTop .who .meta{
      font-size: 12px;
      color: rgba(245,243,239,0.70);
    }
    .iconBtn{
      border: 1px solid rgba(245,243,239,0.14);
      background: rgba(245,243,239,0.04);
      color: rgba(245,243,239,0.90);
      cursor:pointer;
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 800;
      font-family:"DM Sans", sans-serif;
    }
    .iconBtn:hover{ background: rgba(245,243,239,0.06); }

    .chat{
      background: linear-gradient(180deg, rgba(0,200,122,0.10), rgba(0,200,122,0.02));
      padding: 14px 14px 18px;
      min-height: 380px;
      max-height: 66vh;
      overflow:auto;
    }
    .bubbleRow{
      display:flex;
      margin: 10px 0;
    }
    .bubbleRow.sent{ justify-content:flex-end; }
    .bubbleRow.recv{ justify-content:flex-start; }
    .bubble{
      max-width: 78%;
      font-size: 13px;
      line-height: 1.35;
      padding: 10px 12px;
      border-radius: 16px;
      box-shadow: 0 10px 22px rgba(0,0,0,0.25);
      white-space: pre-wrap;
    }
    .bubble.sent{
      background: rgba(245,243,239,0.92);
      color: var(--ink);
      border-top-right-radius: 6px;
    }
    .bubble.recv{
      background: rgba(245,243,239,0.14);
      color: rgba(245,243,239,0.92);
      border-top-left-radius: 6px;
      border: 1px solid rgba(245,243,239,0.16);
    }
    .chatMeta{
      font-size: 11px;
      color: rgba(245,243,239,0.62);
      margin-top: 6px;
    }

    /* Screen 3 */
    .results{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 12px;
    }
    .resultBox{
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 12px;
      background: rgba(245,243,239,0.04);
    }
    .resultBox .label{
      font-size: 12px;
      color: rgba(245,243,239,0.72);
      margin-bottom: 8px;
    }
    .resultBox .value{
      font-family: "Syne", sans-serif;
      font-weight: 800;
      font-size: 20px;
      letter-spacing: -0.02em;
    }
    .resultBox.green{ border-color: rgba(0,200,122,0.34); background: rgba(0,200,122,0.10); }
    .resultBox.yellow{ border-color: rgba(245,213,94,0.30); background: rgba(245,213,94,0.10); }
    .resultBox.gray{ border-color: rgba(245,243,239,0.12); background: rgba(245,243,239,0.03); }

    .timeline{
      display:grid;
      gap: 10px;
      margin-top: 10px;
    }
    .tlItem{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(245,243,239,0.10);
      background: rgba(245,243,239,0.03);
    }
    .tlItem .name{
      font-weight: 800;
      color: rgba(245,243,239,0.92);
    }
    .steps{
      font-size: 12px;
      color: rgba(245,243,239,0.74);
      margin-top: 6px;
    }
    .steps .ok{ color: rgba(0,200,122,0.95); font-weight: 800; }
    .steps .warn{ color: rgba(245,213,94,0.95); font-weight: 800; }
    .steps .muted{ color: rgba(245,243,239,0.62); }

    .callout{
      margin-top: 12px;
      border-radius: 18px;
      border: 1px solid rgba(0,200,122,0.35);
      background: rgba(0,200,122,0.12);
      padding: 14px;
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
    }
    .callout strong{
      font-family:"Syne", sans-serif;
      font-weight: 800;
      letter-spacing:-0.02em;
    }

    /* Footer ROI */
    .roi{
      margin-top: 14px;
      border: 1px solid rgba(255,77,28,0.25);
      background: rgba(255,77,28,0.10);
      border-radius: 18px;
      padding: 12px;
      color: rgba(245,243,239,0.90);
    }
    .roi .top{
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
    }
    .roi .big{
      font-family:"Syne", sans-serif;
      font-weight: 800;
      font-size: 16px;
      letter-spacing:-0.02em;
    }
    .roi .small{
      font-size: 12px;
      color: rgba(245,243,239,0.72);
      margin-top: 6px;
    }

    /* Responsive */
    @media (max-width: 980px){
      .metrics{ grid-template-columns: repeat(2, minmax(0,1fr)); }
      .split{ grid-template-columns: 1fr; }
      .results{ grid-template-columns: 1fr; }
    }
    @media (max-width: 480px){
      .metric .value, .resultBox .value{ font-size: 18px; }
      thead th{ font-size: 11px; }
      tbody td{ font-size: 13px; }
      .barRow{ grid-template-columns: 72px 1fr 92px; }
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="titleblock">
          <div class="kicker">Ventia</div>
          <h1>COBROSMART ‚Äî Demo</h1>
        </div>
      </div>

      <div class="headerRight">
        <div class="pill"><strong>Negocio:</strong> El Puente (Azul, BA)</div>
        <div class="pill"><strong>Due√±o:</strong> Gustavo ‚ÄúTavo‚Äù Ibarra</div>
      </div>
    </header>

    <!-- SCREEN 1 -->
    <section id="screen1" class="screen active">
      <div class="grid">
        <div class="card">
          <h2>Resumen de deuda y foco</h2>
          <div class="subtle">Vista r√°pida para decidir d√≥nde cobrar primero (datos ficticios).</div>

          <div class="metrics" style="margin-top:12px;">
            <div class="metric">
              <div class="label">Vencido total</div>
              <div class="value">$7.980.000</div>
              <div class="hint">Cuenta corriente vencida</div>
            </div>
            <div class="metric">
              <div class="label">Deudores vencidos</div>
              <div class="value">33</div>
              <div class="hint">+7 d√≠as</div>
            </div>
            <div class="metric">
              <div class="label">Vencido 31+ d√≠as</div>
              <div class="value">$4.310.000</div>
              <div class="hint">Foco de recuperaci√≥n</div>
            </div>
            <div class="metric">
              <div class="label">Promesas activas</div>
              <div class="value">1</div>
              <div class="hint">Seguimiento autom√°tico</div>
            </div>
          </div>

          <div class="card" style="margin-top:14px; background: rgba(245,243,239,0.03); box-shadow:none;">
            <h2 style="margin-bottom:6px;">Distribuci√≥n por antig√ºedad</h2>
            <div class="subtle">Las de 31+ d√≠as se priorizan (verde m√°s intenso).</div>

            <div class="barwrap" id="ageBars" aria-label="Gr√°fico por antig√ºedad"></div>
          </div>

          <div class="btnRow" style="margin-top:14px;">
            <button class="btn btnPrimary" id="btnStart">
              Iniciar campa√±a de cobro ‚Üí
            </button>
            <button class="btn btnGhost" id="btnJumpToResults" title="Atajo para demo presencial">
              Saltar a resultados (atajo)
            </button>
          </div>
        </div>

        <div class="roi">
          <div class="top">
            <div class="big">ROI de la demo: recuperable conservador 30 d√≠as (20%) ‚Üí <span style="color:var(--paper);">$862.000</span></div>
            <div class="pill" style="border-color: rgba(255,77,28,0.25); background: rgba(255,77,28,0.08);">
              <strong>Vencido 31+:</strong> $4.310.000
            </div>
          </div>
          <div class="small">
            Con que recuperes una deuda media de <strong>$180.000‚Äì$250.000</strong> en el mes, esto ya se pag√≥ varias veces.
          </div>
        </div>
      </div>
    </section>

    <!-- SCREEN 2 -->
    <section id="screen2" class="screen">
      <div class="grid">
        <div class="card">
          <div class="panelHeader">
            <div>
              <h2>Lista priorizada + mensaje sugerido</h2>
              <div class="subtle">Hac√© click en un deudor para ver el mensaje listo para WhatsApp.</div>
            </div>
            <div class="btnRow">
              <button class="btn btnGhost" id="btnBack1">‚Üê Volver</button>
              <button class="btn btnPrimary" id="btnTo3">Ver resultados ‚Üí</button>
            </div>
          </div>

          <div class="split">
            <div>
              <table aria-label="Tabla de deudores">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th class="tdCenter">D√≠as vencido</th>
                    <th class="tdRight">Monto</th>
                    <th class="tdCenter">Estado</th>
                  </tr>
                </thead>
                <tbody id="debtorsTbody"></tbody>
              </table>

              <div class="hintCard" style="margin-top:12px;">
                Tip: en una demo guiada, empez√° por <strong>31+ d√≠as</strong> (m√°s recuperable) y dej√° ‚Äúprometi√≥‚Äù para mostrar seguimiento autom√°tico.
              </div>
            </div>

            <div class="card" style="margin:0; background: rgba(245,243,239,0.03); box-shadow:none;">
              <div class="panelHeader">
                <div>
                  <h3 id="panelName">Seleccion√° un deudor</h3>
                  <div class="subtle" id="panelMeta">Vas a ver el mensaje sugerido y la conversaci√≥n simulada.</div>
                </div>
                <button class="iconBtn" id="btnConversation" disabled>Ver conversaci√≥n</button>
              </div>

              <div class="toneRow">
                <div class="subtle" style="margin-right:6px;">Tono:</div>
                <div class="seg" role="tablist" aria-label="Selector de tono">
                  <button id="toneAmable" class="" type="button">Amable</button>
                  <button id="toneDirecto" class="" type="button">Directo</button>
                  <button id="toneUltimo" class="" type="button">√öltimo aviso</button>
                </div>
              </div>

              <div class="msgPreview">
                <div class="label">Preview WhatsApp (listo para enviar)</div>
                <div class="msgBubble" id="msgBubble">Eleg√≠ un deudor para ver el mensaje sugerido.</div>
              </div>

              <div class="smallActions">
                <button class="btn btnGhost" id="btnCopy" disabled>Copiar texto</button>
                <button class="btn btnGhost" id="btnMarkSent" disabled>Marcar como ‚ÄúEnviado‚Äù (simulado)</button>
              </div>

              <div class="hintCard" style="margin-top:12px;">
                COBROSMART ajusta el tono seg√∫n antig√ºedad y comportamiento (ignor√≥ / prometi√≥ / sin contacto).
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SCREEN 3 -->
    <section id="screen3" class="screen">
      <div class="grid">
        <div class="card">
          <div class="panelHeader">
            <div>
              <h2>Resultado del d√≠a</h2>
              <div class="subtle">Resumen autom√°tico despu√©s de la campa√±a (simulado).</div>
            </div>
            <div class="btnRow">
              <button class="btn btnGhost" id="btnBack2">‚Üê Volver a mensajes</button>
              <button class="btn btnPrimary" id="btnHome">‚Üê Volver al inicio</button>
            </div>
          </div>

          <div class="results">
            <div class="resultBox green">
              <div class="label">Pagaron</div>
              <div class="value">$186.900</div>
              <div class="subtle">Nico Barrionuevo</div>
            </div>
            <div class="resultBox yellow">
              <div class="label">Prometieron</div>
              <div class="value">$78.300</div>
              <div class="subtle">Mariela Sosa ‚Äî viernes 9:30</div>
            </div>
            <div class="resultBox gray">
              <div class="label">Sin respuesta</div>
              <div class="value">$910.400</div>
              <div class="subtle">Obras Rivas + Cuadrilla Los Hermanos</div>
            </div>
          </div>

          <div class="card" style="margin-top:14px; background: rgba(245,243,239,0.03); box-shadow:none;">
            <h2 style="margin-bottom:6px;">Mini ranking (estado actualizado)</h2>
            <div class="subtle">Qui√©n pag√≥, qui√©n prometi√≥ y a qui√©n seguir ma√±ana.</div>

            <div id="ranking" class="timeline" aria-label="Ranking de deudores"></div>
          </div>

          <div class="card" style="margin-top:14px; background: rgba(245,243,239,0.03); box-shadow:none;">
            <h2 style="margin-bottom:6px;">L√≠nea de tiempo simplificada</h2>
            <div class="subtle">Cada deudor recorre pasos: enviado ‚Üí respuesta ‚Üí resultado.</div>
            <div id="timeline" class="timeline" aria-label="Timeline de resultados"></div>
          </div>

          <div class="callout">
            <div>
              <strong>Acciones autom√°ticas programadas para ma√±ana:</strong>
              <span style="margin-left:8px; color: rgba(245,243,239,0.92); font-weight:800;">2 seguimientos</span>
            </div>
            <div class="pill" style="border-color: rgba(0,200,122,0.30); background: rgba(0,200,122,0.10);">
              <strong>Autom√°tico</strong> (sin backend, demo)
            </div>
          </div>
        </div>

        <div class="roi">
          <div class="top">
            <div class="big">Momento ROI: con 1 deuda media recuperada, se paga solo.</div>
            <div class="pill"><strong>Recuperable 30 d√≠as:</strong> $862.000</div>
          </div>
          <div class="small">
            ‚ÄúCon que recuperes una deuda media de $180.000‚Äì$250.000 en el mes, esto ya se pag√≥ varias veces.‚Äù
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- WhatsApp conversation modal -->
  <div class="modalBackdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-label="Conversaci√≥n WhatsApp simulada">
    <div class="modal">
      <div class="modalTop">
        <div class="who">
          <div class="name" id="chatName">‚Äî</div>
          <div class="meta" id="chatMeta">Simulaci√≥n WhatsApp</div>
        </div>
        <button class="iconBtn" id="btnCloseModal">Cerrar</button>
      </div>
      <div class="chat" id="chatBody"></div>
    </div>
  </div>

  <script>
    // ---------- Data (hardcoded) ----------
    const moneyARS = (v) => {
      // v is number in ARS
      const s = Math.round(v).toString();
      const withDots = s.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
      return "$" + withDots;
    };

    const ageBuckets = [
      { key: "0‚Äì15d", amount: 1620000, prio: false },
      { key: "16‚Äì30d", amount: 2050000, prio: false },
      { key: "31‚Äì60d", amount: 1880000, prio: true },   // green more intense
      { key: "61+d", amount: 2430000, prio: true }
    ];

    const debtors = [
      {
        id: "rivas",
        name: "Obras Rivas",
        days: 74,
        amount: 612400,
        status: "Ignor√≥",
        statusColor: "red",
        defaultTone: "ultimo",
        messages: {
          amable: "Buenas, ¬øc√≥mo va? Te escribo por la cuenta del corral√≥n: qued√≥ pendiente " + moneyARS(612400) + " (vencida hace 74 d√≠as). ¬øMe confirm√°s cu√°ndo lo pueden regularizar as√≠ lo dejamos ordenado?",
          directo: "Buenas, por la cuenta del corral√≥n: qued√≥ pendiente " + moneyARS(612400) + " (74 d√≠as). Necesito fecha concreta de pago para dejarlo agendado. ¬øQu√© d√≠a lo pueden saldar?",
          ultimo: "Buenas, vuelvo con esto as√≠ lo ordenamos: si hoy me pasan fecha de pago, lo dejamos agendado y listo.\nSi ya lo pagaron, ignoren este mensaje y me mandan comprobante cuando puedan."
        },
        conversation: {
          amable: [
            { who: "sent", text: "Hola, ¬øc√≥mo va? Te escribo por la cuenta del corral√≥n. Qued√≥ pendiente " + moneyARS(612400) + " (vencida hace 74 d√≠as). ¬øMe confirm√°s cu√°ndo lo pueden regularizar?" },
            { who: "recv", text: "Dale, lo veo y te aviso." },
            { who: "sent", text: "Perfecto, gracias. Con una fecha lo dejamos agendado y listo." },
            { who: "recv", text: "‚Ä¶" }
          ],
          directo: [
            { who: "sent", text: "Buenas, por la cuenta del corral√≥n: qued√≥ pendiente " + moneyARS(612400) + " (74 d√≠as). Necesito fecha concreta de pago. ¬øQu√© d√≠a lo pueden saldar?" },
            { who: "recv", text: "Lo reviso." },
            { who: "sent", text: "Gracias. Me sirve una fecha concreta para cerrar la cuenta." }
          ],
          ultimo: [
            { who: "sent", text: "Buenas, vuelvo con esto as√≠ lo ordenamos: si hoy me pasan fecha de pago, lo dejamos agendado y listo.\nSi ya lo pagaron, ignoren este mensaje y me mandan comprobante cuando puedan." },
            { who: "recv", text: "‚Ä¶" },
            { who: "sent", text: "Te leo cuando me confirmes una fecha. As√≠ evitamos idas y vueltas." }
          ]
        }
      },
      {
        id: "nico",
        name: "Nico Barrionuevo (Alba√±il)",
        days: 19,
        amount: 186900,
        status: "Prometi√≥",
        statusColor: "green",
        defaultTone: "amable",
        messages: {
          amable: "Hola Nico, ¬øc√≥mo va? Te escribo por la cuenta del corral√≥n: qued√≥ pendiente " + moneyARS(186900) + " de los materiales de la semana pasada. ¬øTe queda c√≥modo saldarlo hoy as√≠ te lo dejo al d√≠a?",
          directo: "Hola Nico, te escribo por la cuenta del corral√≥n: qued√≥ pendiente " + moneyARS(186900) + " (19 d√≠as). ¬øLo pod√©s regularizar hoy? As√≠ lo dejo cerrado.",
          ultimo: "Hola Nico, vuelvo por la cuenta pendiente de " + moneyARS(186900) + ". Necesito confirmaci√≥n de pago hoy o una fecha concreta para dejarlo agendado."
        },
        conversation: {
          amable: [
            { who: "sent", text: "Hola Nico, ¬øc√≥mo va? Qued√≥ pendiente " + moneyARS(186900) + " de los materiales de la semana pasada. ¬øTe queda c√≥modo saldarlo hoy as√≠ te lo dejo al d√≠a?" },
            { who: "recv", text: "S√≠, hoy a la tarde lo paso por transferencia." },
            { who: "sent", text: "Genial, gracias. Cuando tengas el comprobante me lo mand√°s y lo cierro." },
            { who: "recv", text: "Listo, ah√≠ te va. ‚úÖ" }
          ],
          directo: [
            { who: "sent", text: "Hola Nico, qued√≥ pendiente " + moneyARS(186900) + " (19 d√≠as). ¬øLo pod√©s regularizar hoy?" },
            { who: "recv", text: "S√≠, lo hago ahora." },
            { who: "sent", text: "Perfecto, pasame comprobante y queda cerrado." }
          ],
          ultimo: [
            { who: "sent", text: "Hola Nico, vuelvo por la cuenta pendiente de " + moneyARS(186900) + ". Necesito confirmaci√≥n de pago hoy o una fecha concreta." },
            { who: "recv", text: "Hoy lo pago, tranqui." }
          ]
        }
      },
      {
        id: "mariela",
        name: "Mariela Sosa",
        days: 11,
        amount: 78300,
        status: "Sin contacto",
        statusColor: "yellow",
        defaultTone: "amable",
        messages: {
          amable: "Hola Mariela, ¬øtodo bien? Te aviso para que no se te pase: qued√≥ pendiente " + moneyARS(78300) + ". ¬øLo pod√©s resolver hoy o prefer√≠s que lo dejemos para ma√±ana?",
          directo: "Hola Mariela, qued√≥ pendiente " + moneyARS(78300) + " (11 d√≠as). ¬øMe confirm√°s si lo pod√©s abonar hoy o ma√±ana?",
          ultimo: "Hola Mariela, vuelvo por el saldo pendiente de " + moneyARS(78300) + ". Necesito que me confirmes fecha de pago para agendarlo."
        },
        conversation: {
          amable: [
            { who: "sent", text: "Hola Mariela, ¬øtodo bien? Te aviso para que no se te pase: qued√≥ pendiente " + moneyARS(78300) + ". ¬øLo pod√©s resolver hoy o prefer√≠s que lo dejemos para ma√±ana?" },
            { who: "recv", text: "Gracias, me re colgu√©. ¬øPuede ser el viernes a las 9:30?" },
            { who: "sent", text: "S√≠, perfecto. Lo agendo para viernes 9:30. üôå" }
          ],
          directo: [
            { who: "sent", text: "Hola Mariela, qued√≥ pendiente " + moneyARS(78300) + " (11 d√≠as). ¬øLo pod√©s abonar hoy o ma√±ana?" },
            { who: "recv", text: "El viernes a la ma√±ana." },
            { who: "sent", text: "Dale, ¬øte va 9:30 as√≠ lo dejo agendado?" },
            { who: "recv", text: "S√≠, 9:30." }
          ],
          ultimo: [
            { who: "sent", text: "Hola Mariela, vuelvo por el saldo pendiente de " + moneyARS(78300) + ". Necesito que me confirmes fecha de pago para agendarlo." },
            { who: "recv", text: "El viernes 9:30." },
            { who: "sent", text: "Listo, agendado. Gracias." }
          ]
        }
      },
      {
        id: "hermanos",
        name: 'Cuadrilla "Los Hermanos"',
        days: 46,
        amount: 298000,
        status: "Ignor√≥",
        statusColor: "red",
        defaultTone: "directo",
        messages: {
          amable: "Hola, ¬øc√≥mo andan? Les escribo por la cuenta del corral√≥n: qued√≥ pendiente " + moneyARS(298000) + " (46 d√≠as). ¬øMe confirman si lo pueden regularizar hoy o qu√© fecha les queda c√≥moda?",
          directo: "Hola, les escribo por la cuenta: qued√≥ pendiente " + moneyARS(298000) + " (vencida hace 46 d√≠as). ¬øMe confirman cu√°ndo lo pueden regularizar?",
          ultimo: "Hola, vuelvo por el saldo pendiente de " + moneyARS(298000) + " (46 d√≠as). Necesito fecha de pago hoy para dejarlo agendado, o comprobante si ya lo abonaron."
        },
        conversation: {
          amable: [
            { who: "sent", text: "Hola, ¬øc√≥mo andan? Les escribo por la cuenta del corral√≥n: qued√≥ pendiente " + moneyARS(298000) + " (46 d√≠as). ¬øMe confirman qu√© fecha les queda c√≥moda para regularizar?" },
            { who: "recv", text: "‚Ä¶" },
            { who: "sent", text: "Con una fecha lo dejamos ordenado y listo." }
          ],
          directo: [
            { who: "sent", text: "Hola, les escribo por la cuenta: qued√≥ pendiente " + moneyARS(298000) + " (vencida hace 46 d√≠as). ¬øMe confirman cu√°ndo lo pueden regularizar?" },
            { who: "recv", text: "‚Ä¶" },
            { who: "sent", text: "Quedo atento. Si ya lo abonaron, me mandan comprobante cuando puedan." }
          ],
          ultimo: [
            { who: "sent", text: "Hola, vuelvo por el saldo pendiente de " + moneyARS(298000) + " (46 d√≠as). Necesito fecha de pago hoy para dejarlo agendado, o comprobante si ya lo abonaron." },
            { who: "recv", text: "‚Ä¶" },
            { who: "sent", text: "Si hoy me confirman fecha, lo dejo agendado y listo." }
          ]
        }
      }
    ];

    // Screen 3 hardcoded results/timeline (matches spec)
    const dayResult = {
      paid: { amount: 186900, who: "Nico Barrionuevo" },
      promised: { amount: 78300, who: "Mariela Sosa", when: "viernes 9:30" },
      noAnswer: { amount: 910400, who: "Obras Rivas + Cuadrilla Los Hermanos" },
      scheduledFollowups: 2
    };

    // ---------- UI helpers ----------
    const $ = (sel) => document.querySelector(sel);
    const $$ = (sel) => Array.from(document.querySelectorAll(sel));

    function showScreen(n){
      $$(".screen").forEach(s => s.classList.remove("active"));
      $("#screen" + n).classList.add("active");
      // tiny UX improvement: scroll top on navigation
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function statusBadge(statusColor, text){
      const cls = statusColor === "red" ? "status-red" : statusColor === "green" ? "status-green" : "status-yellow";
      return `<span class="badge ${cls}"><span class="dot"></span>${text}</span>`;
    }

    function escapeHtml(str){
      return str.replace(/[&<>"']/g, (m) => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;" }[m]));
    }

    // ---------- Render Screen 1 bars ----------
    function renderAgeBars(){
      const max = Math.max(...ageBuckets.map(b => b.amount));
      const container = $("#ageBars");
      container.innerHTML = "";
      ageBuckets.forEach((b, i) => {
        const pct = Math.max(6, Math.round((b.amount / max) * 100));
        const row = document.createElement("div");
        row.className = "barRow" + (b.prio ? (i === 2 ? " prio2" : " prio") : "");
        row.innerHTML = `
          <div class="bucket">${b.key}</div>
          <div class="bar" aria-hidden="true"><span style="width:${pct}%;"></span></div>
          <div class="amt">${moneyARS(b.amount)}</div>
        `;
        container.appendChild(row);
      });
    }

    // ---------- Render Screen 2 table ----------
    function renderDebtorsTable(){
      const tbody = $("#debtorsTbody");
      tbody.innerHTML = "";
      debtors.forEach(d => {
        const tr = document.createElement("tr");
        tr.dataset.id = d.id;
        tr.innerHTML = `
          <td>${escapeHtml(d.name)}</td>
          <td class="tdCenter">${d.days}</td>
          <td class="tdRight">${moneyARS(d.amount)}</td>
          <td class="tdCenter">${statusBadge(d.statusColor, d.status)}</td>
        `;
        tr.addEventListener("click", () => selectDebtor(d.id));
        tbody.appendChild(tr);
      });
    }

    // ---------- Panel state ----------
    let selectedDebtorId = null;
    let selectedTone = "amable";
    let sentMap = {}; // id -> boolean (simulated)

    function setTone(tone){
      selectedTone = tone;
      // Toggle active button
      $("#toneAmable").classList.toggle("active", tone === "amable");
      $("#toneDirecto").classList.toggle("active", tone === "directo");
      $("#toneUltimo").classList.toggle("active", tone === "ultimo");

      updatePanelMessage();
    }

    function getDebtorById(id){
      return debtors.find(d => d.id === id);
    }

    function updatePanelMessage(){
      const d = selectedDebtorId ? getDebtorById(selectedDebtorId) : null;
      if(!d){
        $("#msgBubble").textContent = "Eleg√≠ un deudor para ver el mensaje sugerido.";
        $("#btnConversation").disabled = true;
        $("#btnCopy").disabled = true;
        $("#btnMarkSent").disabled = true;
        return;
      }
      const text = d.messages[selectedTone] || "";
      $("#msgBubble").textContent = text;
    }

    function selectDebtor(id){
      selectedDebtorId = id;
      const d = getDebtorById(id);

      // highlight row
      $$("#debtorsTbody tr").forEach(tr => tr.classList.toggle("selected", tr.dataset.id === id));

      // Set default tone for this debtor on first selection
      selectedTone = d.defaultTone;
      setTone(selectedTone);

      $("#panelName").textContent = d.name;
      $("#panelMeta").textContent = `${d.days} d√≠as vencido ¬∑ ${moneyARS(d.amount)} ¬∑ Estado: ${d.status}`;
      $("#btnConversation").disabled = false;
      $("#btnCopy").disabled = false;
      $("#btnMarkSent").disabled = false;

      // Update mark sent label
      $("#btnMarkSent").textContent = sentMap[id] ? "Marcado como ‚ÄúEnviado‚Äù ‚úì (simulado)" : "Marcar como ‚ÄúEnviado‚Äù (simulado)";
      $("#btnMarkSent").style.borderColor = sentMap[id] ? "rgba(0,200,122,0.35)" : "rgba(245,243,239,0.14)";
      $("#btnMarkSent").style.background = sentMap[id] ? "rgba(0,200,122,0.10)" : "rgba(245,243,239,0.04)";
    }

    // ---------- WhatsApp modal ----------
    function openConversation(){
      const d = selectedDebtorId ? getDebtorById(selectedDebtorId) : null;
      if(!d) return;

      $("#chatName").textContent = d.name;
      $("#chatMeta").textContent = "Simulaci√≥n WhatsApp ¬∑ Fondo verde oscuro ¬∑ Burbuja blanca (enviado) / gris (recibido)";

      const seq = d.conversation[selectedTone] || [];
      const chatBody = $("#chatBody");
      chatBody.innerHTML = "";

      // Add a subtle "header" system message
      const sys = document.createElement("div");
      sys.className = "chatMeta";
      sys.textContent = "Hoy ¬∑ Mensajes simulados (no se env√≠a nada)";
      chatBody.appendChild(sys);

      seq.forEach(m => {
        const row = document.createElement("div");
        row.className = "bubbleRow " + (m.who === "sent" ? "sent" : "recv");

        const bubble = document.createElement("div");
        bubble.className = "bubble " + (m.who === "sent" ? "sent" : "recv");
        bubble.textContent = m.text;

        row.appendChild(bubble);
        chatBody.appendChild(row);
      });

      $("#modalBackdrop").classList.add("open");
      // scroll bottom
      setTimeout(() => { chatBody.scrollTop = chatBody.scrollHeight; }, 0);
    }

    function closeConversation(){
      $("#modalBackdrop").classList.remove("open");
    }

    // ---------- Screen 3 rendering ----------
    function renderScreen3(){
      // ranking
      const ranking = $("#ranking");
      ranking.innerHTML = "";

      const items = [
        { name: "Nico Barrionuevo", right: statusBadge("green","Pag√≥"), desc: "Monto: " + moneyARS(186900) },
        { name: "Mariela Sosa", right: statusBadge("yellow","Prometi√≥"), desc: "Monto: " + moneyARS(78300) + " ¬∑ " + dayResult.promised.when },
        { name: "Obras Rivas", right: statusBadge("red","Sin respuesta"), desc: "Seguimiento programado" },
        { name: 'Cuadrilla "Los Hermanos"', right: statusBadge("red","Sin respuesta"), desc: "Seguimiento programado" }
      ];

      items.forEach(it => {
        const div = document.createElement("div");
        div.className = "tlItem";
        div.innerHTML = `
          <div>
            <div class="name">${escapeHtml(it.name)}</div>
            <div class="steps">${escapeHtml(it.desc)}</div>
          </div>
          <div>${it.right}</div>
        `;
        ranking.appendChild(div);
      });

      // timeline
      const timeline = $("#timeline");
      timeline.innerHTML = "";

      const tl = [
        {
          name: "Nico",
          steps: `enviado ‚Üí respondi√≥ ‚Üí <span class="ok">pag√≥ ‚úì</span>`
        },
        {
          name: "Mariela",
          steps: `enviado ‚Üí respondi√≥ ‚Üí <span class="warn">prometi√≥</span> (viernes 9:30)`
        },
        {
          name: "Obras Rivas",
          steps: `enviado ‚Üí <span class="muted">sin respuesta</span> ‚Üí seguimiento programado`
        },
        {
          name: "Cuadrilla",
          steps: `enviado ‚Üí <span class="muted">sin respuesta</span> ‚Üí seguimiento programado`
        }
      ];

      tl.forEach(t => {
        const div = document.createElement("div");
        div.className = "tlItem";
        div.innerHTML = `
          <div>
            <div class="name">${escapeHtml(t.name)}</div>
            <div class="steps">${t.steps}</div>
          </div>
          <div class="subtle">hoy</div>
        `;
        timeline.appendChild(div);
      });
    }

    // ---------- Wiring ----------
    renderAgeBars();
    renderDebtorsTable();
    renderScreen3();

    // Default selection (nice for demos)
    // Select a high-impact one first: Obras Rivas
    setTimeout(() => selectDebtor("rivas"), 0);

    // Navigation buttons
    $("#btnStart").addEventListener("click", () => showScreen(2));
    $("#btnJumpToResults").addEventListener("click", () => showScreen(3));

    $("#btnBack1").addEventListener("click", () => showScreen(1));
    $("#btnTo3").addEventListener("click", () => showScreen(3));
    $("#btnBack2").addEventListener("click", () => showScreen(2));
    $("#btnHome").addEventListener("click", () => showScreen(1));

    // Tone selector
    $("#toneAmable").addEventListener("click", () => setTone("amable"));
    $("#toneDirecto").addEventListener("click", () => setTone("directo"));
    $("#toneUltimo").addEventListener("click", () => setTone("ultimo"));

    // Copy
    $("#btnCopy").addEventListener("click", async () => {
      const text = $("#msgBubble").textContent || "";
      try{
        await navigator.clipboard.writeText(text);
        const b = $("#btnCopy");
        const prev = b.textContent;
        b.textContent = "Copiado ‚úì";
        setTimeout(()=> b.textContent = prev, 1200);
      }catch(e){
        // Fallback: select text
        alert("No pude acceder al portapapeles en este navegador. Copi√° el texto manualmente.");
      }
    });

    // Mark as sent (simulated)
    $("#btnMarkSent").addEventListener("click", () => {
      if(!selectedDebtorId) return;
      sentMap[selectedDebtorId] = true;
      $("#btnMarkSent").textContent = "Marcado como ‚ÄúEnviado‚Äù ‚úì (simulado)";
      $("#btnMarkSent").style.borderColor = "rgba(0,200,122,0.35)";
      $("#btnMarkSent").style.background = "rgba(0,200,122,0.10)";
    });

    // Conversation modal
    $("#btnConversation").addEventListener("click", openConversation);
    $("#btnCloseModal").addEventListener("click", closeConversation);
    $("#modalBackdrop").addEventListener("click", (e) => {
      if(e.target === $("#modalBackdrop")) closeConversation();
    });
    document.addEventListener("keydown", (e) => {
      if(e.key === "Escape") closeConversation();
    });

    // Improve: if debtor changes, keep default tone unless user changed manually.
    // (We already reset to debtor default on select. That's fine for demo.)

  </script>
</body>
</html>
