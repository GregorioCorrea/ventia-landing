<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ventia ‚Äî COBROSMART Demo</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0a0a0a;
      --paper:#f5f3ef;
      --ink:#111111;
      --muted:#8a8a8a;
      --green:#00c87a;
      --green-dim:rgba(0,200,122,0.12);
      --accent:#ff4d1c;
      --card:rgba(255,255,255,0.04);
      --border:rgba(255,255,255,0.10);
      --border-strong:rgba(255,255,255,0.16);
      --shadow:0 20px 48px rgba(0,0,0,0.40);
      --radius:16px;
      --font-display:'Plus Jakarta Sans', system-ui, sans-serif;
      --font-body:'IBM Plex Sans', system-ui, sans-serif;
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    html,body{ height:100%; }
    body{
      background:
        radial-gradient(ellipse 1000px 500px at 15% -5%, rgba(0,200,122,0.14) 0%, transparent 60%),
        radial-gradient(ellipse 700px 400px at 95% 8%, rgba(255,77,28,0.09) 0%, transparent 55%),
        var(--bg);
      color:var(--paper);
      font-family:var(--font-body);
      font-size:14px;
      line-height:1.5;
      -webkit-font-smoothing:antialiased;
    }

    /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
    .app{ max-width:1120px; margin:0 auto; padding:16px 16px 48px; }

    /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
    header{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:10px 0 20px; flex-wrap:wrap;
    }
    .brand{ display:flex; align-items:center; gap:10px; }
    .logo-svg{ width:32px; height:32px; flex-shrink:0; }
    .brand-text .kicker{
      font-family:var(--font-body); font-size:11px; font-weight:500;
      letter-spacing:0.08em; text-transform:uppercase;
      color:rgba(245,243,239,0.55);
    }
    .brand-text h1{
      font-family:var(--font-display); font-weight:800; font-size:17px;
      letter-spacing:-0.02em; color:var(--paper); line-height:1.1;
    }
    .pills{ display:flex; gap:8px; flex-wrap:wrap; }
    .pill{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 12px; border:1px solid var(--border);
      background:rgba(255,255,255,0.03); border-radius:999px;
      font-family:var(--font-body); font-size:12px; font-weight:400;
      color:rgba(245,243,239,0.70);
    }
    .pill strong{ font-weight:600; color:rgba(245,243,239,0.90); }

    /* ‚îÄ‚îÄ Screen transitions ‚îÄ‚îÄ */
    .screen{ display:none; animation:fadeUp 220ms ease-out; }
    .screen.active{ display:block; }
    @keyframes fadeUp{
      from{ opacity:0; transform:translateY(6px); }
      to{ opacity:1; transform:translateY(0); }
    }

    /* ‚îÄ‚îÄ Cards ‚îÄ‚îÄ */
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:var(--radius); padding:20px;
    }
    .card + .card{ margin-top:12px; }
    .card h2{
      font-family:var(--font-display); font-weight:700; font-size:15px;
      letter-spacing:-0.01em; margin-bottom:4px;
    }
    .subtle{ font-size:13px; color:rgba(245,243,239,0.55); font-weight:400; }

    /* ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ */
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:8px; padding:10px 18px; border:0; border-radius:12px;
      font-family:var(--font-display); font-size:13px; font-weight:700;
      cursor:pointer; transition:all 0.12s ease; user-select:none;
      white-space:nowrap;
    }
    .btn:active{ transform:scale(0.98); }
    .btn-primary{
      background:var(--green); color:var(--ink);
      box-shadow:0 8px 24px rgba(0,200,122,0.25);
    }
    .btn-primary:hover{ filter:brightness(1.05); box-shadow:0 12px 32px rgba(0,200,122,0.35); }
    .btn-ghost{
      background:rgba(255,255,255,0.05); border:1px solid var(--border);
      color:rgba(245,243,239,0.85);
    }
    .btn-ghost:hover{ background:rgba(255,255,255,0.08); }
    .btn-sm{ padding:8px 14px; font-size:12px; border-radius:10px; }
    .btn-row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }

    /* ‚îÄ‚îÄ Screen 1 ‚Äî Metrics ‚îÄ‚îÄ */
    .metrics{
      display:grid;
      grid-template-columns:repeat(4, minmax(0,1fr));
      gap:10px; margin:16px 0;
    }
    .metric{
      background:rgba(255,255,255,0.03); border:1px solid var(--border);
      border-radius:14px; padding:14px;
    }
    .metric .m-label{
      font-size:11px; font-weight:500; letter-spacing:0.04em;
      text-transform:uppercase; color:rgba(245,243,239,0.50);
      margin-bottom:8px;
    }
    .metric .m-value{
      font-family:var(--font-display); font-weight:800; font-size:22px;
      letter-spacing:-0.03em; line-height:1;
    }
    .metric .m-hint{
      font-size:12px; color:rgba(245,243,239,0.45); margin-top:6px;
    }

    /* ‚îÄ‚îÄ Age bars ‚îÄ‚îÄ */
    .bars{ display:grid; gap:8px; margin-top:14px; }
    .bar-row{
      display:grid; grid-template-columns:76px 1fr 108px;
      gap:10px; align-items:center;
      padding:9px 12px; border-radius:12px;
      border:1px solid rgba(255,255,255,0.07);
      background:rgba(255,255,255,0.025);
    }
    .bar-row .b-label{
      font-family:var(--font-body); font-size:12px; font-weight:500;
      color:rgba(245,243,239,0.75);
    }
    .bar-track{
      height:8px; border-radius:999px;
      background:rgba(255,255,255,0.08); overflow:hidden;
    }
    .bar-fill{
      height:100%; border-radius:999px;
      background:rgba(0,200,122,0.50);
      transition:width 0.6s cubic-bezier(0.16,1,0.3,1);
    }
    .bar-row.prio .bar-fill{ background:rgba(0,200,122,0.90); }
    .bar-row.prio2 .bar-fill{ background:rgba(0,200,122,0.75); }
    .bar-row .b-amt{
      font-family:var(--font-body); font-size:12px; font-weight:500;
      color:rgba(245,243,239,0.80); text-align:right;
      font-variant-numeric:tabular-nums;
    }

    /* ‚îÄ‚îÄ ROI strip ‚îÄ‚îÄ */
    .roi-strip{
      margin-top:12px; padding:14px 16px;
      border:1px solid rgba(255,77,28,0.22);
      background:rgba(255,77,28,0.08); border-radius:14px;
    }
    .roi-strip .roi-top{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; flex-wrap:wrap;
    }
    .roi-strip .roi-big{
      font-family:var(--font-display); font-weight:700; font-size:14px;
      letter-spacing:-0.01em;
    }
    .roi-strip .roi-big span{ color:var(--paper); }
    .roi-strip .roi-small{
      font-size:12px; color:rgba(245,243,239,0.60);
      margin-top:6px; line-height:1.4;
    }

    /* ‚îÄ‚îÄ Screen 2 ‚îÄ‚îÄ */
    .split{
      display:grid; grid-template-columns:1.2fr 0.8fr;
      gap:14px; align-items:start; margin-top:14px;
    }

    /* Table */
    .table-wrap{ overflow:hidden; border-radius:var(--radius); border:1px solid var(--border); }
    table{ width:100%; border-collapse:collapse; }
    thead th{
      font-family:var(--font-body); font-size:11px; font-weight:600;
      letter-spacing:0.05em; text-transform:uppercase;
      color:rgba(245,243,239,0.50); padding:10px 14px;
      border-bottom:1px solid var(--border); background:rgba(255,255,255,0.03);
      text-align:left;
    }
    thead th.tc{ text-align:center; }
    thead th.tr{ text-align:right; }
    tbody tr{
      cursor:pointer; transition:background 0.10s ease;
      border-bottom:1px solid rgba(255,255,255,0.06);
    }
    tbody tr:last-child{ border-bottom:0; }
    tbody tr:hover{ background:rgba(255,255,255,0.04); }
    tbody tr.selected{
      background:rgba(0,200,122,0.08);
      outline:1px solid rgba(0,200,122,0.35);
      outline-offset:-1px;
    }
    tbody td{
      font-family:var(--font-body); font-size:13px; font-weight:400;
      color:rgba(245,243,239,0.85); padding:11px 14px;
      vertical-align:middle;
    }
    td.tc{ text-align:center; }
    td.tr{ text-align:right; font-variant-numeric:tabular-nums; font-weight:500; }

    /* Badges */
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      padding:5px 10px; border-radius:999px; font-size:11px;
      font-family:var(--font-body); font-weight:600;
      border:1px solid var(--border); white-space:nowrap;
    }
    .dot{ width:7px; height:7px; border-radius:50%; }
    .s-red{ border-color:rgba(255,77,28,0.30); background:rgba(255,77,28,0.10); }
    .s-red .dot{ background:var(--accent); }
    .s-yellow{ border-color:rgba(245,213,60,0.30); background:rgba(245,213,60,0.10); }
    .s-yellow .dot{ background:rgba(245,213,60,0.95); }
    .s-green{ border-color:rgba(0,200,122,0.30); background:rgba(0,200,122,0.10); }
    .s-green .dot{ background:var(--green); }

    /* Message panel */
    .msg-panel{ display:flex; flex-direction:column; gap:12px; }
    .panel-head{ display:flex; align-items:flex-start; justify-content:space-between; gap:8px; }
    .panel-head h3{
      font-family:var(--font-display); font-weight:700; font-size:14px;
      letter-spacing:-0.01em; line-height:1.2;
    }
    .panel-head .p-meta{ font-size:12px; color:rgba(245,243,239,0.50); margin-top:3px; }

    /* Tone segmented control */
    .tone-seg{
      display:flex; border:1px solid var(--border);
      border-radius:10px; overflow:hidden; width:fit-content;
    }
    .tone-seg button{
      border:0; cursor:pointer; padding:8px 14px;
      background:transparent; color:rgba(245,243,239,0.70);
      font-family:var(--font-display); font-size:12px; font-weight:600;
      transition:background 0.10s ease, color 0.10s ease;
    }
    .tone-seg button:not(:last-child){ border-right:1px solid var(--border); }
    .tone-seg button.active{
      background:rgba(0,200,122,0.15); color:rgba(245,243,239,0.95);
    }
    .tone-seg button:hover:not(.active){ background:rgba(255,255,255,0.05); }

    /* WhatsApp preview bubble */
    .msg-preview{
      background:rgba(0,0,0,0.30); border:1px solid rgba(255,255,255,0.08);
      border-radius:14px; padding:14px; min-height:120px;
    }
    .msg-preview .preview-label{
      font-size:11px; font-weight:500; letter-spacing:0.04em;
      text-transform:uppercase; color:rgba(245,243,239,0.40); margin-bottom:10px;
    }
    .msg-bubble{
      background:rgba(245,243,239,0.93); color:var(--ink);
      border-radius:14px; border-bottom-right-radius:4px;
      padding:10px 13px; font-family:var(--font-body);
      font-size:13px; line-height:1.45; white-space:pre-wrap;
      box-shadow:0 6px 18px rgba(0,0,0,0.22);
      max-width:96%;
    }
    .msg-bubble.placeholder{ color:rgba(10,10,10,0.45); font-style:italic; }

    .hint-card{
      padding:10px 13px; border:1px dashed rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.02); border-radius:12px;
      font-size:12px; color:rgba(245,243,239,0.60); line-height:1.4;
    }
    .hint-card strong{ color:rgba(245,243,239,0.85); }

    /* Screen 2 nav ‚Äî bottom bar */
    .screen2-nav{
      display:flex; justify-content:space-between; align-items:center;
      gap:10px; margin-top:16px; flex-wrap:wrap;
    }

    /* ‚îÄ‚îÄ Screen 3 ‚îÄ‚îÄ */
    .results-grid{
      display:grid; grid-template-columns:repeat(3,minmax(0,1fr));
      gap:10px; margin:14px 0;
    }
    .result-box{
      border-radius:14px; border:1px solid var(--border);
      background:rgba(255,255,255,0.03); padding:14px;
    }
    .result-box .r-label{
      font-size:11px; font-weight:600; letter-spacing:0.04em;
      text-transform:uppercase; color:rgba(245,243,239,0.50); margin-bottom:8px;
    }
    .result-box .r-value{
      font-family:var(--font-display); font-weight:800; font-size:22px;
      letter-spacing:-0.03em; line-height:1;
    }
    .result-box .r-sub{
      font-size:12px; color:rgba(245,243,239,0.50); margin-top:5px;
    }
    .result-box.rb-green{ border-color:rgba(0,200,122,0.30); background:rgba(0,200,122,0.08); }
    .result-box.rb-yellow{ border-color:rgba(245,213,60,0.28); background:rgba(245,213,60,0.08); }
    .result-box.rb-gray{ border-color:rgba(255,255,255,0.10); }

    .tl-list{ display:grid; gap:8px; margin-top:12px; }
    .tl-item{
      display:flex; align-items:flex-start; justify-content:space-between;
      gap:10px; padding:10px 14px; border-radius:12px;
      border:1px solid rgba(255,255,255,0.08);
      background:rgba(255,255,255,0.02);
    }
    .tl-item .tl-name{
      font-family:var(--font-display); font-weight:700; font-size:13px;
      letter-spacing:-0.01em;
    }
    .tl-item .tl-desc{
      font-size:12px; color:rgba(245,243,239,0.55); margin-top:3px;
    }
    .tl-steps{ font-size:12px; color:rgba(245,243,239,0.60); margin-top:4px; line-height:1.4; }
    .tl-steps .ok{ color:rgba(0,200,122,0.95); font-weight:700; }
    .tl-steps .warn{ color:rgba(245,213,60,0.95); font-weight:700; }
    .tl-steps .dim{ color:rgba(245,243,239,0.45); }

    .callout-bar{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; flex-wrap:wrap; padding:14px 16px;
      border:1px solid rgba(0,200,122,0.30);
      background:rgba(0,200,122,0.10); border-radius:14px;
      margin-top:12px;
    }
    .callout-bar .cb-text{
      font-family:var(--font-display); font-weight:700; font-size:14px;
    }
    .callout-bar .cb-num{
      color:var(--green); font-size:15px;
    }

    /* ‚îÄ‚îÄ WhatsApp modal ‚îÄ‚îÄ */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(0,0,0,0.65);
      display:none; align-items:center; justify-content:center;
      padding:16px; z-index:50;
    }
    .modal-backdrop.open{ display:flex; }
    .modal{
      width:min(540px,100%); border-radius:20px;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(12,12,12,0.95);
      box-shadow:0 30px 70px rgba(0,0,0,0.60); overflow:hidden;
    }
    .modal-top{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; padding:12px 16px;
      border-bottom:1px solid rgba(255,255,255,0.08);
      background:rgba(255,255,255,0.025);
    }
    .modal-who .mw-name{
      font-family:var(--font-display); font-weight:700; font-size:14px;
      letter-spacing:-0.01em;
    }
    .modal-who .mw-meta{
      font-size:11px; color:rgba(245,243,239,0.55); margin-top:2px;
    }
    .chat-body{
      background:linear-gradient(180deg, rgba(0,200,122,0.09) 0%, rgba(0,200,122,0.03) 100%);
      padding:16px; min-height:360px; max-height:60vh; overflow-y:auto;
      display:flex; flex-direction:column; gap:10px;
    }
    .chat-sys{
      text-align:center; font-size:11px;
      color:rgba(245,243,239,0.45); margin-bottom:4px;
    }
    .bubble-row{ display:flex; }
    .bubble-row.sent{ justify-content:flex-end; }
    .bubble-row.recv{ justify-content:flex-start; }
    .chat-bubble{
      max-width:80%; padding:10px 13px; border-radius:16px;
      font-family:var(--font-body); font-size:13px; line-height:1.4;
      white-space:pre-wrap; box-shadow:0 4px 12px rgba(0,0,0,0.25);
    }
    .chat-bubble.sent{
      background:rgba(245,243,239,0.94); color:var(--ink);
      border-bottom-right-radius:4px;
    }
    .chat-bubble.recv{
      background:rgba(255,255,255,0.10); color:rgba(245,243,239,0.90);
      border:1px solid rgba(255,255,255,0.12); border-bottom-left-radius:4px;
    }

    /* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
    @media(max-width:900px){
      .metrics{ grid-template-columns:repeat(2,minmax(0,1fr)); }
      .split{ grid-template-columns:1fr; }
      .results-grid{ grid-template-columns:1fr; }
    }
    @media(max-width:480px){
      .metric .m-value{ font-size:18px; }
      .result-box .r-value{ font-size:18px; }
      .bar-row{ grid-template-columns:60px 1fr 86px; }
      thead th{ font-size:10px; padding:8px 10px; }
      tbody td{ font-size:12px; padding:9px 10px; }
    }
  </style>
</head>
<body>
<div class="app">

  <header>
    <div class="brand">
      <svg class="logo-svg" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="32" height="32" rx="9" fill="#0a0a0a"/>
        <path d="M6 22 L12 12 L16 18 L20 9 L26 9" stroke="#00c87a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="26" cy="9" r="2.2" fill="#00c87a"/>
      </svg>
      <div class="brand-text">
        <div class="kicker">Ventia</div>
        <h1>COBROSMART ‚Äî Demo</h1>
      </div>
    </div>
    <div class="pills">
      <div class="pill"><strong>Negocio:</strong> El Puente (Azul, BA)</div>
      <div class="pill"><strong>Due√±o:</strong> Gustavo "Tavo" Ibarra</div>
    </div>
  </header>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       SCREEN 1 ‚Äî RESUMEN DE DEUDA
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section id="s1" class="screen active">
    <div class="card">
      <h2>Resumen de deuda y foco</h2>
      <div class="subtle">Vista r√°pida para decidir d√≥nde cobrar primero ‚Äî datos ficticios.</div>

      <div class="metrics">
        <div class="metric">
          <div class="m-label">Vencido total</div>
          <div class="m-value">$7.980.000</div>
          <div class="m-hint">Cuenta corriente</div>
        </div>
        <div class="metric">
          <div class="m-label">Deudores vencidos</div>
          <div class="m-value">33</div>
          <div class="m-hint">+7 d√≠as</div>
        </div>
        <div class="metric">
          <div class="m-label">Vencido 31+ d√≠as</div>
          <div class="m-value">$4.310.000</div>
          <div class="m-hint">Foco de recuperaci√≥n</div>
        </div>
        <div class="metric">
          <div class="m-label">Promesas activas</div>
          <div class="m-value">1</div>
          <div class="m-hint">Seguimiento auto</div>
        </div>
      </div>

      <div class="card" style="background:rgba(255,255,255,0.02); box-shadow:none; border-color:rgba(255,255,255,0.07);">
        <h2>Distribuci√≥n por antig√ºedad</h2>
        <div class="subtle" style="margin-bottom:4px;">Las franjas de 31+ d√≠as se priorizan (verde m√°s intenso).</div>
        <div class="bars" id="ageBars"></div>
      </div>

      <div class="btn-row" style="margin-top:16px;">
        <button class="btn btn-primary" id="btnStart">Iniciar campa√±a de cobro ‚Üí</button>
        <button class="btn btn-ghost" id="btnJump">Saltar a resultados</button>
      </div>
    </div>

    <div class="roi-strip">
      <div class="roi-top">
        <div class="roi-big">ROI conservador 30 d√≠as (20%) ‚Üí <span>$862.000</span></div>
        <div class="pill" style="border-color:rgba(255,77,28,0.22); background:rgba(255,77,28,0.07);">
          <strong>Vencido 31+:</strong> $4.310.000
        </div>
      </div>
      <div class="roi-small">Con que recuper√©s una deuda media de <strong style="color:rgba(245,243,239,0.85);">$180.000‚Äì$250.000</strong> en el mes, esto ya se pag√≥ varias veces.</div>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       SCREEN 2 ‚Äî LISTA + MENSAJE
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section id="s2" class="screen">
    <div class="card">
      <h2>Lista priorizada + mensaje sugerido</h2>
      <div class="subtle">Hac√© click en un deudor para ver el mensaje listo para WhatsApp.</div>

      <div class="split">
        <!-- Tabla -->
        <div>
          <div class="table-wrap">
            <table aria-label="Deudores">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th class="tc">D√≠as</th>
                  <th class="tr">Monto</th>
                  <th class="tc">Estado</th>
                </tr>
              </thead>
              <tbody id="debtorsTbody"></tbody>
            </table>
          </div>
          <div class="hint-card" style="margin-top:10px;">
            Tip: en una demo guiada, empez√° por <strong>31+ d√≠as</strong> y dej√° "prometi√≥" para mostrar el seguimiento autom√°tico.
          </div>
        </div>

        <!-- Panel mensaje -->
        <div class="msg-panel card" style="margin:0; background:rgba(255,255,255,0.02); box-shadow:none; border-color:rgba(255,255,255,0.07);">
          <div class="panel-head">
            <div>
              <h3 id="panelName">Seleccion√° un deudor</h3>
              <div class="p-meta" id="panelMeta">Vas a ver el mensaje sugerido y la conversaci√≥n.</div>
            </div>
            <button class="btn btn-ghost btn-sm" id="btnConv" disabled>Ver conversaci√≥n</button>
          </div>

          <div>
            <div class="subtle" style="margin-bottom:6px; font-size:11px; text-transform:uppercase; letter-spacing:0.05em;">Tono del mensaje</div>
            <div class="tone-seg" role="group" aria-label="Tono">
              <button id="tA" type="button">Amable</button>
              <button id="tD" type="button">Directo</button>
              <button id="tU" type="button">√öltimo aviso</button>
            </div>
          </div>

          <div class="msg-preview">
            <div class="preview-label">Preview WhatsApp</div>
            <div class="msg-bubble placeholder" id="msgBubble">Eleg√≠ un deudor para ver el mensaje.</div>
          </div>

          <div class="btn-row">
            <button class="btn btn-ghost btn-sm" id="btnCopy" disabled>Copiar texto</button>
            <button class="btn btn-ghost btn-sm" id="btnSent" disabled>Marcar enviado</button>
          </div>

          <div class="hint-card">
            COBROSMART ajusta el tono seg√∫n antig√ºedad y comportamiento ‚Äî <strong>ignor√≥ / prometi√≥ / sin contacto.</strong>
          </div>
        </div>
      </div>

      <!-- Nav bottom -->
      <div class="screen2-nav">
        <button class="btn btn-ghost" id="btnBack1">‚Üê Volver</button>
        <button class="btn btn-primary" id="btnTo3">Ver resultados ‚Üí</button>
      </div>
    </div>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       SCREEN 3 ‚Äî RESULTADO DEL D√çA
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section id="s3" class="screen">
    <div class="card">
      <h2>Resultado del d√≠a</h2>
      <div class="subtle">Resumen autom√°tico despu√©s de la campa√±a ‚Äî simulado.</div>

      <div class="results-grid">
        <div class="result-box rb-green">
          <div class="r-label">Pagaron</div>
          <div class="r-value">$186.900</div>
          <div class="r-sub">Nico Barrionuevo</div>
        </div>
        <div class="result-box rb-yellow">
          <div class="r-label">Prometieron</div>
          <div class="r-value">$78.300</div>
          <div class="r-sub">Mariela Sosa ‚Äî viernes 9:30</div>
        </div>
        <div class="result-box rb-gray">
          <div class="r-label">Sin respuesta</div>
          <div class="r-value">$910.400</div>
          <div class="r-sub">Obras Rivas + Cuadrilla Los Hermanos</div>
        </div>
      </div>

      <div class="card" style="background:rgba(255,255,255,0.02); box-shadow:none; border-color:rgba(255,255,255,0.07);">
        <h2>Estado actualizado</h2>
        <div class="subtle">Qui√©n pag√≥, qui√©n prometi√≥ y a qui√©n seguir ma√±ana.</div>
        <div class="tl-list" id="ranking"></div>
      </div>

      <div class="card" style="background:rgba(255,255,255,0.02); box-shadow:none; border-color:rgba(255,255,255,0.07); margin-top:10px;">
        <h2>L√≠nea de tiempo</h2>
        <div class="subtle">Cada deudor: enviado ‚Üí respuesta ‚Üí resultado.</div>
        <div class="tl-list" id="timeline"></div>
      </div>

      <div class="callout-bar">
        <div>
          <span class="cb-text">Acciones autom√°ticas programadas para ma√±ana: </span>
          <span class="cb-num">2 seguimientos</span>
        </div>
        <div class="pill" style="border-color:rgba(0,200,122,0.28); background:rgba(0,200,122,0.08);">
          Sin backend ‚Äî demo
        </div>
      </div>

      <div class="roi-strip" style="margin-top:12px;">
        <div class="roi-top">
          <div class="roi-big">Momento ROI: con 1 deuda media recuperada, <span>se paga solo.</span></div>
          <div class="pill"><strong>Recuperable 30 d√≠as:</strong> $862.000</div>
        </div>
        <div class="roi-small">"Con que recuper√©s una deuda media de $180.000‚Äì$250.000 en el mes, esto ya se pag√≥ varias veces."</div>
      </div>

      <div class="btn-row" style="margin-top:16px;">
        <button class="btn btn-ghost" id="btnBack2">‚Üê Volver a mensajes</button>
        <button class="btn btn-ghost" id="btnHome">‚Üê Volver al inicio</button>
      </div>
    </div>
  </section>

</div>

<!-- WhatsApp Modal -->
<div class="modal-backdrop" id="modalBg" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="modal-top">
      <div class="modal-who">
        <div class="mw-name" id="chatName">‚Äî</div>
        <div class="mw-meta">Simulaci√≥n WhatsApp ¬∑ solo demo</div>
      </div>
      <button class="btn btn-ghost btn-sm" id="btnClose">Cerrar</button>
    </div>
    <div class="chat-body" id="chatBody"></div>
  </div>
</div>

<script>
  /* ‚îÄ‚îÄ Data ‚îÄ‚îÄ */
  const fmt = n => "$" + Math.round(n).toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");

  const buckets = [
    { key:"0‚Äì15d",  amount:1620000, cls:"" },
    { key:"16‚Äì30d", amount:2050000, cls:"" },
    { key:"31‚Äì60d", amount:1880000, cls:"prio2" },
    { key:"61+d",   amount:2430000, cls:"prio" }
  ];

  const debtors = [
    {
      id:"rivas", name:"Obras Rivas", days:74, amount:612400,
      status:"Ignor√≥", sc:"red", defaultTone:"ultimo",
      messages:{
        amable:`Buenas, ¬øc√≥mo va? Les escribo por la cuenta del corral√≥n: qued√≥ pendiente ${fmt(612400)} (vencida hace 74 d√≠as). ¬øMe confirman cu√°ndo lo pueden regularizar as√≠ lo dejamos ordenado?`,
        directo:`Buenas, por la cuenta: qued√≥ pendiente ${fmt(612400)} (74 d√≠as). Necesito una fecha concreta para dejarlo agendado. ¬øQu√© d√≠a lo pueden saldar?`,
        ultimo:`Buenas, vuelvo con esto as√≠ lo ordenamos: si hoy me pasan fecha de pago, lo dejamos agendado y listo.\nSi ya lo pagaron, ignoren este mensaje y me mandan comprobante cuando puedan.`
      },
      conv:{
        amable:[
          {who:"sent", text:`Hola, ¬øc√≥mo va? Les escribo por la cuenta del corral√≥n. Qued√≥ pendiente ${fmt(612400)} (74 d√≠as). ¬øMe confirman cu√°ndo lo pueden regularizar?`},
          {who:"recv", text:"Dale, lo veo y te aviso."},
          {who:"sent", text:"Perfecto. Con una fecha lo dejamos agendado y listo."},
          {who:"recv", text:"‚Ä¶"}
        ],
        directo:[
          {who:"sent", text:`Buenas, por la cuenta: qued√≥ pendiente ${fmt(612400)} (74 d√≠as). Necesito fecha concreta de pago. ¬øQu√© d√≠a lo pueden saldar?`},
          {who:"recv", text:"Lo reviso."},
          {who:"sent", text:"Gracias. Me sirve una fecha para cerrar la cuenta."}
        ],
        ultimo:[
          {who:"sent", text:`Buenas, vuelvo con esto as√≠ lo ordenamos: si hoy me pasan fecha de pago, lo dejamos agendado y listo.\nSi ya lo pagaron, ignoren este mensaje y m√°ndenme comprobante cuando puedan.`},
          {who:"recv", text:"‚Ä¶"},
          {who:"sent", text:"Te leo cuando me confirmes una fecha."}
        ]
      }
    },
    {
      id:"nico", name:"Nico Barrionuevo (Alba√±il)", days:19, amount:186900,
      status:"Prometi√≥", sc:"green", defaultTone:"amable",
      messages:{
        amable:`Hola Nico, ¬øc√≥mo va? Te escribo por la cuenta del corral√≥n: qued√≥ pendiente ${fmt(186900)} de los materiales de la semana pasada. ¬øTe queda c√≥modo saldarlo hoy as√≠ te lo dejo al d√≠a?`,
        directo:`Hola Nico, qued√≥ pendiente ${fmt(186900)} (19 d√≠as). ¬øLo pod√©s regularizar hoy? As√≠ lo dejo cerrado.`,
        ultimo:`Hola Nico, vuelvo por la cuenta pendiente de ${fmt(186900)}. Necesito confirmaci√≥n de pago hoy o una fecha concreta.`
      },
      conv:{
        amable:[
          {who:"sent", text:`Hola Nico, ¬øc√≥mo va? Qued√≥ pendiente ${fmt(186900)} de los materiales de la semana pasada. ¬øTe queda c√≥modo saldarlo hoy?`},
          {who:"recv", text:"S√≠, hoy a la tarde lo paso por transferencia."},
          {who:"sent", text:"Genial, cuando tengas el comprobante me lo mand√°s y lo cierro."},
          {who:"recv", text:"Listo, ah√≠ va. ‚úÖ"}
        ],
        directo:[
          {who:"sent", text:`Hola Nico, qued√≥ pendiente ${fmt(186900)} (19 d√≠as). ¬øLo pod√©s regularizar hoy?`},
          {who:"recv", text:"S√≠, lo hago ahora."},
          {who:"sent", text:"Perfecto, pasame comprobante y queda cerrado."}
        ],
        ultimo:[
          {who:"sent", text:`Hola Nico, vuelvo por la cuenta pendiente de ${fmt(186900)}. Necesito confirmaci√≥n hoy o fecha concreta.`},
          {who:"recv", text:"Hoy lo pago, tranqui."}
        ]
      }
    },
    {
      id:"mariela", name:"Mariela Sosa", days:11, amount:78300,
      status:"Sin contacto", sc:"yellow", defaultTone:"amable",
      messages:{
        amable:`Hola Mariela, ¬øtodo bien? Te aviso para que no se te pase: qued√≥ pendiente ${fmt(78300)}. ¬øLo pod√©s resolver hoy o prefer√≠s que lo dejemos para ma√±ana?`,
        directo:`Hola Mariela, qued√≥ pendiente ${fmt(78300)} (11 d√≠as). ¬øMe confirm√°s si lo pod√©s abonar hoy o ma√±ana?`,
        ultimo:`Hola Mariela, vuelvo por el saldo pendiente de ${fmt(78300)}. Necesito que me confirmes fecha de pago.`
      },
      conv:{
        amable:[
          {who:"sent", text:`Hola Mariela, ¬øtodo bien? Te aviso para que no se te pase: qued√≥ pendiente ${fmt(78300)}. ¬øLo pod√©s resolver hoy o prefer√≠s ma√±ana?`},
          {who:"recv", text:"Gracias, me re colgu√©. ¬øPuede ser el viernes a las 9:30?"},
          {who:"sent", text:"S√≠, perfecto. Lo agendo para viernes 9:30. üôå"}
        ],
        directo:[
          {who:"sent", text:`Hola Mariela, qued√≥ pendiente ${fmt(78300)} (11 d√≠as). ¬øLo pod√©s abonar hoy o ma√±ana?`},
          {who:"recv", text:"El viernes a la ma√±ana."},
          {who:"sent", text:"Dale, ¬øte va 9:30 as√≠ lo dejo agendado?"},
          {who:"recv", text:"S√≠, 9:30."}
        ],
        ultimo:[
          {who:"sent", text:`Hola Mariela, vuelvo por el saldo de ${fmt(78300)}. Dame fecha de pago para agendarlo.`},
          {who:"recv", text:"El viernes 9:30."},
          {who:"sent", text:"Listo, agendado. Gracias."}
        ]
      }
    },
    {
      id:"hermanos", name:'Cuadrilla "Los Hermanos"', days:46, amount:298000,
      status:"Ignor√≥", sc:"red", defaultTone:"directo",
      messages:{
        amable:`Hola, ¬øc√≥mo andan? Les escribo por la cuenta del corral√≥n: qued√≥ pendiente ${fmt(298000)} (46 d√≠as). ¬øMe confirman qu√© fecha les queda c√≥moda para regularizar?`,
        directo:`Hola, les escribo por la cuenta: qued√≥ pendiente ${fmt(298000)} (vencida hace 46 d√≠as). ¬øMe confirman cu√°ndo lo pueden regularizar?`,
        ultimo:`Hola, vuelvo por el saldo de ${fmt(298000)} (46 d√≠as). Necesito fecha de pago hoy para agendarlo, o comprobante si ya lo abonaron.`
      },
      conv:{
        amable:[
          {who:"sent", text:`Hola, ¬øc√≥mo andan? Qued√≥ pendiente ${fmt(298000)} (46 d√≠as). ¬øMe confirman qu√© fecha les queda c√≥moda?`},
          {who:"recv", text:"‚Ä¶"},
          {who:"sent", text:"Con una fecha lo dejamos ordenado y listo."}
        ],
        directo:[
          {who:"sent", text:`Hola, qued√≥ pendiente ${fmt(298000)} (46 d√≠as). ¬øCu√°ndo lo pueden regularizar?`},
          {who:"recv", text:"‚Ä¶"},
          {who:"sent", text:"Si ya lo abonaron, me mandan comprobante cuando puedan."}
        ],
        ultimo:[
          {who:"sent", text:`Hola, vuelvo por el saldo de ${fmt(298000)} (46 d√≠as). Necesito fecha hoy para agendarlo, o comprobante si ya lo pagaron.`},
          {who:"recv", text:"‚Ä¶"},
          {who:"sent", text:"Si hoy me confirman fecha, lo dejo agendado y listo."}
        ]
      }
    }
  ];

  /* ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ */
  const $  = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const esc = s => s.replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));

  function showScreen(n){
    $$(".screen").forEach(s=>s.classList.remove("active"));
    $("#s"+n).classList.add("active");
    window.scrollTo({top:0, behavior:"smooth"});
  }

  function badge(sc, text){
    const cls = sc==="red"?"s-red": sc==="green"?"s-green":"s-yellow";
    return `<span class="badge ${cls}"><span class="dot"></span>${esc(text)}</span>`;
  }

  /* ‚îÄ‚îÄ Render bars ‚îÄ‚îÄ */
  function renderBars(){
    const max = Math.max(...buckets.map(b=>b.amount));
    const el = $("#ageBars");
    el.innerHTML = "";
    buckets.forEach(b=>{
      const pct = Math.max(6, Math.round(b.amount/max*100));
      el.insertAdjacentHTML("beforeend",`
        <div class="bar-row ${b.cls}">
          <div class="b-label">${b.key}</div>
          <div class="bar-track"><div class="bar-fill" style="width:${pct}%"></div></div>
          <div class="b-amt">${fmt(b.amount)}</div>
        </div>`);
    });
  }

  /* ‚îÄ‚îÄ Render table ‚îÄ‚îÄ */
  function renderTable(){
    const tbody = $("#debtorsTbody");
    tbody.innerHTML = "";
    debtors.forEach(d=>{
      const tr = document.createElement("tr");
      tr.dataset.id = d.id;
      tr.innerHTML = `
        <td>${esc(d.name)}</td>
        <td class="tc">${d.days}</td>
        <td class="tr">${fmt(d.amount)}</td>
        <td class="tc">${badge(d.sc, d.status)}</td>`;
      tr.addEventListener("click",()=>selectDebtor(d.id));
      tbody.appendChild(tr);
    });
  }

  /* ‚îÄ‚îÄ Render screen 3 ‚îÄ‚îÄ */
  function renderS3(){
    const rankData = [
      {name:"Nico Barrionuevo", badge:badge("green","Pag√≥"),          desc:fmt(186900)},
      {name:"Mariela Sosa",     badge:badge("yellow","Prometi√≥"),      desc:fmt(78300)+" ¬∑ viernes 9:30"},
      {name:"Obras Rivas",      badge:badge("red","Sin respuesta"),    desc:"Seguimiento programado"},
      {name:'Cuadrilla "Los Hermanos"', badge:badge("red","Sin respuesta"), desc:"Seguimiento programado"}
    ];
    $("#ranking").innerHTML = rankData.map(r=>`
      <div class="tl-item">
        <div><div class="tl-name">${esc(r.name)}</div><div class="tl-desc">${esc(r.desc)}</div></div>
        <div>${r.badge}</div>
      </div>`).join("");

    const tlData = [
      {name:"Nico",       steps:`enviado ‚Üí respondi√≥ ‚Üí <span class="ok">pag√≥ ‚úì</span>`},
      {name:"Mariela",    steps:`enviado ‚Üí respondi√≥ ‚Üí <span class="warn">prometi√≥</span> (viernes 9:30)`},
      {name:"Obras Rivas",steps:`enviado ‚Üí <span class="dim">sin respuesta</span> ‚Üí seguimiento programado`},
      {name:"Cuadrilla",  steps:`enviado ‚Üí <span class="dim">sin respuesta</span> ‚Üí seguimiento programado`}
    ];
    $("#timeline").innerHTML = tlData.map(t=>`
      <div class="tl-item">
        <div><div class="tl-name">${esc(t.name)}</div><div class="tl-steps">${t.steps}</div></div>
        <div class="subtle" style="font-size:11px;">hoy</div>
      </div>`).join("");
  }

  /* ‚îÄ‚îÄ State ‚îÄ‚îÄ */
  let selId = null, tone = "amable";
  const sentMap = {};

  function getD(id){ return debtors.find(d=>d.id===id); }

  function setTone(t){
    tone = t;
    ["A","D","U"].forEach(k=>{
      const map={A:"amable",D:"directo",U:"ultimo"};
      $("#t"+k).classList.toggle("active", map[k]===t);
    });
    updateMsg();
  }

  function updateMsg(){
    const d = selId ? getD(selId) : null;
    const el = $("#msgBubble");
    if(!d){ el.textContent="Eleg√≠ un deudor para ver el mensaje."; el.classList.add("placeholder"); return; }
    el.textContent = d.messages[tone]||"";
    el.classList.remove("placeholder");
  }

  function selectDebtor(id){
    selId = id;
    const d = getD(id);
    $$(" #debtorsTbody tr").forEach(tr=>tr.classList.toggle("selected", tr.dataset.id===id));
    tone = d.defaultTone;
    setTone(tone);
    $("#panelName").textContent = d.name;
    $("#panelMeta").textContent = `${d.days} d√≠as vencido ¬∑ ${fmt(d.amount)} ¬∑ ${d.status}`;
    $("#btnConv").disabled = false;
    $("#btnCopy").disabled = false;
    $("#btnSent").disabled = false;
    const sent = sentMap[id];
    $("#btnSent").textContent = sent ? "Enviado ‚úì" : "Marcar enviado";
    $("#btnSent").style.borderColor = sent ? "rgba(0,200,122,0.35)" : "";
    // On mobile, scroll to message panel
    if(window.innerWidth < 900){
      setTimeout(()=>{ $("#s2 .msg-panel").scrollIntoView({behavior:"smooth", block:"start"}); }, 80);
    }
  }

  /* ‚îÄ‚îÄ Modal ‚îÄ‚îÄ */
  function openModal(){
    const d = selId ? getD(selId) : null;
    if(!d) return;
    $("#chatName").textContent = d.name;
    const body = $("#chatBody");
    body.innerHTML = `<div class="chat-sys">Hoy ¬∑ Mensajes simulados</div>`;
    (d.conv[tone]||[]).forEach(m=>{
      const row = document.createElement("div");
      row.className = "bubble-row " + (m.who==="sent"?"sent":"recv");
      const bub = document.createElement("div");
      bub.className = "chat-bubble " + (m.who==="sent"?"sent":"recv");
      bub.textContent = m.text;
      row.appendChild(bub);
      body.appendChild(row);
    });
    $("#modalBg").classList.add("open");
    setTimeout(()=>{ body.scrollTop = body.scrollHeight; }, 0);
  }
  function closeModal(){ $("#modalBg").classList.remove("open"); }

  /* ‚îÄ‚îÄ Init ‚îÄ‚îÄ */
  renderBars();
  renderTable();
  renderS3();
  setTimeout(()=>selectDebtor("rivas"), 0);

  /* ‚îÄ‚îÄ Events ‚îÄ‚îÄ */
  $("#btnStart").onclick  = ()=>showScreen(2);
  $("#btnJump").onclick   = ()=>showScreen(3);
  $("#btnBack1").onclick  = ()=>showScreen(1);
  $("#btnTo3").onclick    = ()=>showScreen(3);
  $("#btnBack2").onclick  = ()=>showScreen(2);
  $("#btnHome").onclick   = ()=>showScreen(1);

  $("#tA").onclick = ()=>setTone("amable");
  $("#tD").onclick = ()=>setTone("directo");
  $("#tU").onclick = ()=>setTone("ultimo");

  $("#btnConv").onclick = openModal;
  $("#btnClose").onclick = closeModal;
  $("#modalBg").onclick = e=>{ if(e.target===$("#modalBg")) closeModal(); };
  document.addEventListener("keydown", e=>{ if(e.key==="Escape") closeModal(); });

  $("#btnCopy").onclick = async()=>{
    const txt = $("#msgBubble").textContent||"";
    try{
      await navigator.clipboard.writeText(txt);
      const b=$("#btnCopy"), prev=b.textContent;
      b.textContent="Copiado ‚úì"; setTimeout(()=>b.textContent=prev,1200);
    }catch(e){ alert("Copi√° el texto manualmente."); }
  };

  $("#btnSent").onclick = ()=>{
    if(!selId) return;
    sentMap[selId] = true;
    $("#btnSent").textContent = "Enviado ‚úì";
    $("#btnSent").style.borderColor = "rgba(0,200,122,0.35)";
    $("#btnSent").style.background = "rgba(0,200,122,0.08)";
  };
</script>
</body>
</html>
